var e=Symbol.for("immer-nothing"),t=Symbol.for("immer-draftable"),r=Symbol.for("immer-state");function n(e,...t){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var o=Object.getPrototypeOf;function c(e){return!!e&&!!e[r]}function a(e){var r;return!!e&&(i(e)||Array.isArray(e)||!!e[t]||!!(null==(r=e.constructor)?void 0:r[t])||d(e)||y(e))}var s=Object.prototype.constructor.toString();function i(e){if(!e||"object"!=typeof e)return!1;const t=o(e);if(null===t)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===s}function u(e){return c(e)||n(15),e[r].base_}function f(e,t){0===p(e)?Reflect.ownKeys(e).forEach((r=>{t(r,e[r],e)})):e.forEach(((r,n)=>t(n,r,e)))}function p(e){const t=e[r];return t?t.type_:Array.isArray(e)?1:d(e)?2:y(e)?3:0}function l(e,t){return 2===p(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function _(e,t){return 2===p(e)?e.get(t):e[t]}function h(e,t,r){const n=p(e);2===n?e.set(t,r):3===n?e.add(r):e[t]=r}function d(e){return e instanceof Map}function y(e){return e instanceof Set}function b(e){return e.copy_||e.base_}function v(e,t){if(d(e))return new Map(e);if(y(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=i(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[r];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const o=n[r],c=t[o];!1===c.writable&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(t[o]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[o]})}return Object.create(o(e),t)}{const t=o(e);if(null!==t&&n)return{...e};const r=Object.create(t);return Object.assign(r,e)}}function m(e,t=!1){return w(e)||c(e)||!a(e)||(p(e)>1&&(e.set=e.add=e.clear=e.delete=g),Object.freeze(e),t&&Object.entries(e).forEach((([e,t])=>m(t,!0)))),e}function g(){n(2)}function w(e){return Object.isFrozen(e)}var P,S={};function z(e){const t=S[e];return t||n(0),t}function O(){return P}function j(e,t){t&&(z("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function A(e){F(e),e.drafts_.forEach(E),e.drafts_=null}function F(e){e===P&&(P=e.parent_)}function D(e){return P={drafts_:[],parent_:P,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function E(e){const t=e[r];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function C(t,o){o.unfinalizedDrafts_=o.drafts_.length;const c=o.drafts_[0];return void 0!==t&&t!==c?(c[r].modified_&&(A(o),n(4)),a(t)&&(t=M(o,t),o.parent_||k(o,t)),o.patches_&&z("Patches").generateReplacementPatches_(c[r].base_,t,o.patches_,o.inversePatches_)):t=M(o,c,[]),A(o),o.patches_&&o.patchListener_(o.patches_,o.inversePatches_),t!==e?t:void 0}function M(e,t,n){if(w(t))return t;const o=t[r];if(!o)return f(t,((r,c)=>R(e,o,t,r,c,n))),t;if(o.scope_!==e)return t;if(!o.modified_)return k(e,o.base_,!0),o.base_;if(!o.finalized_){o.finalized_=!0,o.scope_.unfinalizedDrafts_--;const t=o.copy_;let r=t,c=!1;3===o.type_&&(r=new Set(t),t.clear(),c=!0),f(r,((r,a)=>R(e,o,t,r,a,n,c))),k(e,t,!1),n&&e.patches_&&z("Patches").generatePatches_(o,n,e.patches_,e.inversePatches_)}return o.copy_}function R(e,t,r,n,o,s,i){if(c(o)){const a=M(e,o,s&&t&&3!==t.type_&&!l(t.assigned_,n)?s.concat(n):void 0);if(h(r,n,a),!c(a))return;e.canAutoFreeze_=!1}else i&&r.add(o);if(a(o)&&!w(o)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;M(e,o),t&&t.scope_.parent_||"symbol"==typeof n||!Object.prototype.propertyIsEnumerable.call(r,n)||k(e,o)}}function k(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&m(t,r)}var N={get(e,t){if(t===r)return e;const n=b(e);if(!l(n,t))return function(e,t,r){var n;const o=W(t,r);return o?"value"in o?o.value:null==(n=o.get)?void 0:n.call(e.draft_):void 0}(e,n,t);const o=n[t];return e.finalized_||!a(o)?o:o===K(e.base_,t)?(I(e),e.copy_[t]=L(o,e)):o},has:(e,t)=>t in b(e),ownKeys:e=>Reflect.ownKeys(b(e)),set(e,t,n){const o=W(b(e),t);if(null==o?void 0:o.set)return o.set.call(e.draft_,n),!0;if(!e.modified_){const o=K(b(e),t),s=null==o?void 0:o[r];if(s&&s.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((c=n)===(a=o)?0!==c||1/c==1/a:c!=c&&a!=a)&&(void 0!==n||l(e.base_,t)))return!0;I(e),U(e)}var c,a;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==K(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,I(e),U(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const r=b(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty(){n(11)},getPrototypeOf:e=>o(e.base_),setPrototypeOf(){n(12)}},x={};function K(e,t){const n=e[r];return(n?b(n):e)[t]}function W(e,t){if(!(t in e))return;let r=o(e);for(;r;){const e=Object.getOwnPropertyDescriptor(r,t);if(e)return e;r=o(r)}}function U(e){e.modified_||(e.modified_=!0,e.parent_&&U(e.parent_))}function I(e){e.copy_||(e.copy_=v(e.base_,e.scope_.immer_.useStrictShallowCopy_))}f(N,((e,t)=>{x[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),x.deleteProperty=function(e,t){return x.set.call(this,e,t,void 0)},x.set=function(e,t,r){return N.set.call(this,e[0],t,r,e[0])};function L(e,t){const r=d(e)?z("MapSet").proxyMap_(e,t):y(e)?z("MapSet").proxySet_(e,t):function(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:O(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let o=n,c=N;r&&(o=[n],c=x);const{revoke:a,proxy:s}=Proxy.revocable(o,c);return n.draft_=s,n.revoke_=a,s}(e,t);return(t?t.scope_:O()).drafts_.push(r),r}function X(e){if(!a(e)||w(e))return e;const t=e[r];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=v(e,t.scope_.immer_.useStrictShallowCopy_)}else n=v(e,!0);return f(n,((e,t)=>{h(n,e,X(t))})),t&&(t.finalized_=!1),n}function q(){const r="replace",s="add",i="remove";function u(e){if(!a(e))return e;if(Array.isArray(e))return e.map(u);if(d(e))return new Map(Array.from(e.entries()).map((([e,t])=>[e,u(t)])));if(y(e))return new Set(Array.from(e).map(u));const r=Object.create(o(e));for(const t in e)r[t]=u(e[t]);return l(e,t)&&(r[t]=e[t]),r}function h(e){return c(e)?u(e):e}var b,v;v={applyPatches_:function(e,t){return t.forEach((t=>{const{path:o,op:c}=t;let a=e;for(let e=0;e<o.length-1;e++){const t=p(a);let r=o[e];"string"!=typeof r&&"number"!=typeof r&&(r=""+r),0!==t&&1!==t||"__proto__"!==r&&"constructor"!==r||n(19),"function"==typeof a&&"prototype"===r&&n(19),a=_(a,r),"object"!=typeof a&&n(18,o.join("/"))}const f=p(a),l=u(t.value),h=o[o.length-1];switch(c){case r:switch(f){case 2:return a.set(h,l);case 3:n(16);default:return a[h]=l}case s:switch(f){case 1:return"-"===h?a.push(l):a.splice(h,0,l);case 2:return a.set(h,l);case 3:return a.add(l);default:return a[h]=l}case i:switch(f){case 1:return a.splice(h,1);case 2:return a.delete(h);case 3:return a.delete(t.value);default:return delete a[h]}default:n(17)}})),e},generatePatches_:function(e,t,n,o){switch(e.type_){case 0:case 2:return function(e,t,n,o){const{base_:c,copy_:a}=e;f(e.assigned_,((e,u)=>{const f=_(c,e),p=_(a,e),d=u?l(c,e)?r:s:i;if(f===p&&d===r)return;const y=t.concat(e);n.push(d===i?{op:d,path:y}:{op:d,path:y,value:p}),o.push(d===s?{op:i,path:y}:d===i?{op:s,path:y,value:h(f)}:{op:r,path:y,value:h(f)})}))}(e,t,n,o);case 1:return function(e,t,n,o){let{base_:c,assigned_:a}=e,u=e.copy_;u.length<c.length&&([c,u]=[u,c],[n,o]=[o,n]);for(let s=0;s<c.length;s++)if(a[s]&&u[s]!==c[s]){const e=t.concat([s]);n.push({op:r,path:e,value:h(u[s])}),o.push({op:r,path:e,value:h(c[s])})}for(let r=c.length;r<u.length;r++){const e=t.concat([r]);n.push({op:s,path:e,value:h(u[r])})}for(let r=u.length-1;c.length<=r;--r){const e=t.concat([r]);o.push({op:i,path:e})}}(e,t,n,o);case 3:return function(e,t,r,n){let{base_:o,copy_:c}=e,a=0;o.forEach((e=>{if(!c.has(e)){const o=t.concat([a]);r.push({op:i,path:o,value:e}),n.unshift({op:s,path:o,value:e})}a++})),a=0,c.forEach((e=>{if(!o.has(e)){const o=t.concat([a]);r.push({op:s,path:o,value:e}),n.unshift({op:i,path:o,value:e})}a++}))}(e,t,n,o)}},generateReplacementPatches_:function(t,n,o,c){o.push({op:r,path:[],value:n===e?void 0:n}),c.push({op:r,path:[],value:t})}},S[b="Patches"]||(S[b]=v)}var B=new class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,o)=>{if("function"==typeof t&&"function"!=typeof r){const e=r;r=t;const n=this;return function(t=e,...o){return n.produce(t,(e=>r.call(this,e,...o)))}}let c;if("function"!=typeof r&&n(6),void 0!==o&&"function"!=typeof o&&n(7),a(t)){const e=D(this),n=L(t,void 0);let a=!0;try{c=r(n),a=!1}finally{a?A(e):F(e)}return j(e,o),C(c,e)}if(!t||"object"!=typeof t){if(c=r(t),void 0===c&&(c=t),c===e&&(c=void 0),this.autoFreeze_&&m(c,!0),o){const e=[],r=[];z("Patches").generateReplacementPatches_(t,c,e,r),o(e,r)}return c}n(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...r)=>this.produceWithPatches(t,(t=>e(t,...r)));let r,n;return[this.produce(e,t,((e,t)=>{r=e,n=t})),r,n]},"boolean"==typeof(null==t?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),"boolean"==typeof(null==t?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(e){a(e)||n(8),c(e)&&(e=function(e){c(e)||n(10);return X(e)}(e));const t=D(this),o=L(e,void 0);return o[r].isManual_=!0,F(t),o}finishDraft(e,t){const o=e&&e[r];o&&o.isManual_||n(9);const{scope_:c}=o;return j(c,t),C(void 0,c)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));const n=z("Patches").applyPatches_;return c(e)?n(e,t):this.produce(e,(e=>n(e,t)))}},G=B.produce,H=B.produceWithPatches.bind(B);B.setAutoFreeze.bind(B),B.setUseStrictShallowCopy.bind(B);var J=B.applyPatches.bind(B);B.createDraft.bind(B),B.finishDraft.bind(B);export{c as a,J as b,H as c,q as e,m as f,a as i,u as o,G as p};
