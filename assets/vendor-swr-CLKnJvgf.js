import{r as e,R as t}from"./vendor-react-BVfqOVDk.js";import{s as n}from"./vendor-use-sync-external-store-Cc7De4aQ.js";import{d as r}from"./vendor-dequal-CLq44rlU.js";const o=new WeakMap,a=()=>{},i=a(),s=Object,c=e=>e===i,u=e=>"function"==typeof e,l=(e,t)=>({...e,...t}),d=e=>u(e.then),f={},g={},h="undefined",v=typeof window!=h,p=typeof document!=h,w=v&&"Deno"in window,m=(e,t)=>{const n=o.get(e);return[()=>!c(t)&&e.get(t)||f,r=>{if(!c(t)){const o=e.get(t);t in g||(g[t]=o),n[5](t,l(o,r),o||f)}},n[6],()=>!c(t)&&t in g?g[t]:!c(t)&&e.get(t)||f]};let y=!0;const[b,O]=v&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[a,a],R={isOnline:()=>y,isVisible:()=>{const e=p&&document.visibilityState;return c(e)||"hidden"!==e}},_={initFocus:e=>(p&&document.addEventListener("visibilitychange",e),b("focus",e),()=>{p&&document.removeEventListener("visibilitychange",e),O("focus",e)}),initReconnect:e=>{const t=()=>{y=!0,e()},n=()=>{y=!1};return b("online",t),b("offline",n),()=>{O("online",t),O("offline",n)}}},E=!t.useId,S=!v||w,k=e=>v&&typeof window.requestAnimationFrame!=h?window.requestAnimationFrame(e):setTimeout(e,1),L=S?e.useEffect:e.useLayoutEffect,T="undefined"!=typeof navigator&&navigator.connection,V=!S&&T&&(["slow-2g","2g"].includes(T.effectiveType)||T.saveData),D=new WeakMap,j=(e,t)=>s.prototype.toString.call(e)==="[object ".concat(t,"]");let C=0;const I=e=>{const t=typeof e,n=j(e,"Date"),r=j(e,"RegExp"),o=j(e,"Object");let a,i;if(s(e)!==e||n||r)a=n?e.toJSON():"symbol"==t?e.toString():"string"==t?JSON.stringify(e):""+e;else{if(a=D.get(e),a)return a;if(a=++C+"~",D.set(e,a),Array.isArray(e)){for(a="@",i=0;i<e.length;i++)a+=I(e[i])+",";D.set(e,a)}if(o){a="#";const t=s.keys(e).sort();for(;!c(i=t.pop());)c(e[i])||(a+=i+":"+I(e[i])+",");D.set(e,a)}}return a},P=e=>{if(u(e))try{e=e()}catch(n){e=""}const t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?I(e):"",t]};let x=0;const F=()=>++x;async function M(...e){const[t,n,r,a]=e,s=l({populateCache:!0,throwOnError:!0},"boolean"==typeof a?{revalidate:a}:a||{});let f=s.populateCache;const g=s.rollbackOnError;let h=s.optimisticData;const v=s.throwOnError;if(u(n)){const e=n,r=[],o=t.keys();for(const n of o)!/^\$(inf|sub)\$/.test(n)&&e(t.get(n)._k)&&r.push(n);return Promise.all(r.map(p))}return p(n);async function p(n){const[a]=P(n);if(!a)return;const[l,p]=m(t,a),[w,y,b,O]=o.get(t),R=()=>{const e=w[a];return(u(s.revalidate)?s.revalidate(l().data,n):!1!==s.revalidate)&&(delete b[a],delete O[a],e&&e[0])?e[0](2).then((()=>l().data)):l().data};if(e.length<3)return R();let _,E=r;const S=F();y[a]=[S,0];const k=!c(h),L=l(),T=L.data,V=L._c,D=c(V)?T:V;if(k&&(h=u(h)?h(D,T):h,p({data:h,_c:D})),u(E))try{E=E(D)}catch(j){_=j}if(E&&d(E)){if(E=await E.catch((e=>{_=e})),S!==y[a][0]){if(_)throw _;return E}_&&k&&(e=>"function"==typeof g?g(e):!1!==g)(_)&&(f=!0,p({data:D,_c:i}))}if(f&&!_)if(u(f)){const e=f(E,D);p({data:e,error:i,_c:i})}else p({data:E,error:i,_c:i});if(y[a][1]=F(),Promise.resolve(R()).then((()=>{p({_c:i})})),!_)return E;if(v)throw _}}const W=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},A=(e,t)=>{if(!o.has(e)){const n=l(_,t),r=Object.create(null),s=M.bind(i,e);let c=a;const u=Object.create(null),d=(e,t)=>{const n=u[e]||[];return u[e]=n,n.push(t),()=>n.splice(n.indexOf(t),1)},f=(t,n,r)=>{e.set(t,n);const o=u[t];if(o)for(const e of o)e(n,r)},g=()=>{if(!o.has(e)&&(o.set(e,[r,Object.create(null),Object.create(null),Object.create(null),s,f,d]),!S)){const t=n.initFocus(setTimeout.bind(i,W.bind(i,r,0))),a=n.initReconnect(setTimeout.bind(i,W.bind(i,r,1)));c=()=>{t&&t(),a&&a(),o.delete(e)}}};return g(),[e,s,g,c]}return[e,o.get(e)[4]]},q=r,[$,J]=A(new Map),N=l({onLoadingSlow:a,onSuccess:a,onError:a,onErrorRetry:(e,t,n,r,o)=>{const a=n.errorRetryCount,i=o.retryCount,s=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!c(a)&&i>a||setTimeout(r,s,o)},onDiscarded:a,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:V?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:V?5e3:3e3,compare:q,isPaused:()=>!1,cache:$,mutate:J,fallback:{}},R),U=(e,t)=>{const n=l(e,t);if(t){const{use:r,fallback:o}=e,{use:a,fallback:i}=t;r&&a&&(n.use=r.concat(a)),o&&i&&(n.fallback=l(o,i))}return n},H=e.createContext({}),z=v&&window.__SWR_DEVTOOLS_USE__,B=z?window.__SWR_DEVTOOLS_USE__:[],G=()=>l(N,e.useContext(H)),K=B.concat((e=>(t,n,r)=>e(t,n&&((...e)=>{const[r]=P(t),[,,,a]=o.get($);if(r.startsWith("$inf$"))return n(...e);const i=a[r];return c(i)?n(...e):(delete a[r],i)}),r)));z&&(window.__SWR_DEVTOOLS_REACT__=t);const Q=t.use||(e=>{switch(e.status){case"pending":throw e;case"fulfilled":return e.value;case"rejected":throw e.reason;default:throw e.status="pending",e.then((t=>{e.status="fulfilled",e.value=t}),(t=>{e.status="rejected",e.reason=t})),e}}),X={dedupe:!0},Y=s.defineProperty((t=>{const{value:n}=t,r=e.useContext(H),o=u(n),a=e.useMemo((()=>o?n(r):n),[o,r,n]),s=e.useMemo((()=>o?a:U(r,a)),[o,r,a]),c=a&&a.provider,d=e.useRef(i);c&&!d.current&&(d.current=A(c(s.cache||$),a));const f=d.current;return f&&(s.cache=f[0],s.mutate=f[1]),L((()=>{if(f)return f[2]&&f[2](),f[3]}),[]),e.createElement(H.Provider,l(t,{value:s}))}),"defaultValue",{value:N}),Z=(ee=(t,r,a)=>{const{cache:s,compare:f,suspense:g,fallbackData:h,revalidateOnMount:v,revalidateIfStale:p,refreshInterval:w,refreshWhenHidden:y,refreshWhenOffline:b,keepPreviousData:O}=a,[R,_,T,V]=o.get(s),[D,j]=P(t),C=e.useRef(!1),I=e.useRef(!1),x=e.useRef(D),W=e.useRef(r),A=e.useRef(a),q=()=>A.current,$=()=>q().isVisible()&&q().isOnline(),[J,N,U,H]=m(s,D),z=e.useRef({}).current,B=c(h)?c(a.fallback)?i:a.fallback[D]:h,G=(e,t)=>{for(const n in z){const r=n;if("data"===r){if(!f(e[r],t[r])){if(!c(e[r]))return!1;if(!f(ae,t[r]))return!1}}else if(t[r]!==e[r])return!1}return!0},K=e.useMemo((()=>{const e=!!D&&!!r&&(c(v)?!q().isPaused()&&!g&&!1!==p:v),t=t=>{const n=l(t);return delete n._k,e?{isValidating:!0,isLoading:!0,...n}:n},n=J(),o=H(),a=t(n),i=n===o?a:t(o);let s=a;return[()=>{const e=t(J());return G(e,s)?(s.data=e.data,s.isLoading=e.isLoading,s.isValidating=e.isValidating,s.error=e.error,s):(s=e,e)},()=>i]}),[s,D]),Y=n.useSyncExternalStore(e.useCallback((e=>U(D,((t,n)=>{G(n,t)||e()}))),[s,D]),K[0],K[1]),Z=!C.current,ee=R[D]&&R[D].length>0,te=Y.data,ne=c(te)?B&&d(B)?Q(B):B:te,re=Y.error,oe=e.useRef(ne),ae=O?c(te)?c(oe.current)?ne:oe.current:te:ne,ie=!(ee&&!c(re))&&(Z&&!c(v)?v:!q().isPaused()&&(g?!c(ne)&&p:c(ne)||p)),se=!!(D&&r&&Z&&ie),ce=c(Y.isValidating)?se:Y.isValidating,ue=c(Y.isLoading)?se:Y.isLoading,le=e.useCallback((async e=>{const t=W.current;if(!D||!t||I.current||q().isPaused())return!1;let n,r,o=!0;const s=e||{},l=!T[D]||!s.dedupe,d=()=>E?!I.current&&D===x.current&&C.current:D===x.current,g={isValidating:!1,isLoading:!1},h=()=>{N(g)},v=()=>{const e=T[D];e&&e[1]===r&&delete T[D]},p={isValidating:!0};c(J().data)&&(p.isLoading=!0);try{if(l&&(N(p),a.loadingTimeout&&c(J().data)&&setTimeout((()=>{o&&d()&&q().onLoadingSlow(D,a)}),a.loadingTimeout),T[D]=[t(j),F()]),[n,r]=T[D],n=await n,l&&setTimeout(v,a.dedupingInterval),!T[D]||T[D][1]!==r)return l&&d()&&q().onDiscarded(D),!1;g.error=i;const e=_[D];if(!c(e)&&(r<=e[0]||r<=e[1]||0===e[1]))return h(),l&&d()&&q().onDiscarded(D),!1;const s=J().data;g.data=f(s,n)?s:n,l&&d()&&q().onSuccess(n,D,a)}catch(w){v();const e=q(),{shouldRetryOnError:t}=e;e.isPaused()||(g.error=w,l&&d()&&(e.onError(w,D,e),(!0===t||u(t)&&t(w))&&(q().revalidateOnFocus&&q().revalidateOnReconnect&&!$()||e.onErrorRetry(w,D,e,(e=>{const t=R[D];t&&t[0]&&t[0](3,e)}),{retryCount:(s.retryCount||0)+1,dedupe:!0}))))}return o=!1,h(),!0}),[D,s]),de=e.useCallback(((...e)=>M(s,x.current,...e)),[]);if(L((()=>{W.current=r,A.current=a,c(te)||(oe.current=te)})),L((()=>{if(!D)return;const e=le.bind(i,X);let t=0;if(q().revalidateOnFocus){const e=Date.now();t=e+q().focusThrottleInterval}const n=((e,t,n)=>{const r=t[e]||(t[e]=[]);return r.push(n),()=>{const e=r.indexOf(n);e>=0&&(r[e]=r[r.length-1],r.pop())}})(D,R,((n,r={})=>{if(0==n){const n=Date.now();q().revalidateOnFocus&&n>t&&$()&&(t=n+q().focusThrottleInterval,e())}else if(1==n)q().revalidateOnReconnect&&$()&&e();else{if(2==n)return le();if(3==n)return le(r)}}));return I.current=!1,x.current=D,C.current=!0,N({_k:j}),ie&&(c(ne)||S?e():k(e)),()=>{I.current=!0,n()}}),[D]),L((()=>{let e;function t(){const t=u(w)?w(J().data):w;t&&-1!==e&&(e=setTimeout(n,t))}function n(){J().error||!y&&!q().isVisible()||!b&&!q().isOnline()?t():le(X).then(t)}return t(),()=>{e&&(clearTimeout(e),e=-1)}}),[w,y,b,D]),e.useDebugValue(ae),g&&c(ne)&&D){if(!E&&S)throw new Error("Fallback data is required when using Suspense in SSR.");W.current=r,A.current=a,I.current=!1;const e=V[D];if(!c(e)){const t=de(e);Q(t)}if(!c(re))throw re;{const e=le(X);c(ae)||(e.status="fulfilled",e.value=!0),Q(e)}}return{mutate:de,get data(){return z.data=!0,ae},get error(){return z.error=!0,re},get isValidating(){return z.isValidating=!0,ce},get isLoading(){return z.isLoading=!0,ue}}},function(...e){const t=G(),[n,r,o]=(e=>u(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}])(e),a=U(t,o);let i=ee;const{use:s}=a,c=(s||[]).concat(K);for(let u=c.length;u--;)i=c[u](i);return i(n,r||a.fetcher||null,a)});var ee;export{Y as S,Z as a,G as u};
